<!DOCTYPE html>
<html lang="en" xmlns="http://www.w3.org/1999/xhtml"
	xmlns:th="http://www.thymeleaf.org">
<head th:replace="fragments/links :: head('Groups')"></head>
<body>
	<!-- Left Panel -->
	<div th:replace="fragments/sidebar :: side"></div>
	<!-- Header-->
	<div id="right-panel" class="right-panel">
		<header th:replace="fragments/header :: headerFrag"></header>
		<!-- /header -->

		<div class="content mt-3" style="padding: 10px;">
			<div class="animated fadeIn">
				<div class="row">

					<div class="col-md-12">
						<div class="card">
							<div class="card-header">
								<strong class="card-title">My Projects</strong>
							</div>
							<div class="card-body">
								<table id="bootstrap-data-table"
									class="table table-striped table-bordered">
									<thead>
										<tr>
											<th>#</th>
											<th>Project Name</th>
											<th>Created Date</th>
										</tr>
									</thead>
									<tbody>
										
									</tbody>
								</table>
							</div>
						</div>
					</div>
				</div>
			</div>
		</div>
	</div>
	<div th:replace="fragments/footer :: foot"></div>

	<!-- .animated -->


	<script>
	$(document).ready(function() {
	       $(function() {
	              var token = $("meta[name='_csrf']").attr("content");
	              var header = $("meta[name='_csrf_header']").attr("content");
	              $(document).ajaxSend(function(e, xhr, options) {
	                    xhr.setRequestHeader(header, token);
	              });
	              
	       });
	       
			var username = $('#username').text();
			$.ajax({
			    url: 'http://localhost:8761/api/db-service/rest/user/' + username,
			    type: 'GET',
			    success: function(data) { 
			    	$('tbody').empty();
			    	$.each(data.project, function(i) {
			    		var createdDate = data.project[i].createdDate;
			    		var date = new Date(Date.UTC(createdDate[0], createdDate[1]-1, createdDate[2]));
			    		
			    		var dt = $('#bootstrap-data-table').dataTable();
				    		dt.fnAddData({DT_RowClass: 'gradeA',
														0: i+1,  
														1: data.project[i].projectName, 
														2: date}, true);
			         });
			    
			    },
			    error: function(data) { alert('Failed!');},
			    xhrFields: {
			        withCredentials: true
			     }
			    
			});
	       
	});
	</script>
</body>
</html>